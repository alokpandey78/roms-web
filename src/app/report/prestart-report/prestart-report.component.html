<mat-card>
  <mat-card-content class="create_user_page">
    <div fxLayout="row wrap">
      <div fxFlex.gt-sm="100" fxFlex="100" fxFlexAlign="center" class="row m-0">
        <form class="basic-form">
          <div fxLayout="row wrap" fxFlexAlign="center" class="row m-0">
            <div fxFlex.gt-sm="100" fxFlex="100" class="bg-success text-white">
              <div fxFlex.gt-sm="80" fxFlex="100">
                <mat-card-title class="text-white; m-l-10 m-t-10"
                  >{{ prestartDetails?.prestartNo }}</mat-card-title
                >
              </div>
              <div fxFlex.gt-sm="20" fxFlex="100">
                <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                  <mat-label>
                    {{ prestartDetails?.createDate | date }} 
                  </mat-label>
                </div>
                <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                  <mat-label>  {{ prestartDetails?.createDate | date:'shortTime' }}</mat-label>
                </div>
              </div>
            </div>
            <mat-divider fxFlex.gt-sm="100" fxFlex="100" class="m-b-10"> </mat-divider>
            <div fxFlex.gt-sm="18" fxFlex="100">
              <div fxFlex.gt-sm="100" fxFlex="100">
                <div class="m-t-10 asset-img">
                  <img
                    onerror="this.onerror=null;this.src='../../assets/img/default-asset.jpg';"
                    [src]="
                      globals.generateFileUrl(
                        prestartDetails && prestartDetails.assets.assetImage
                          ? prestartDetails.assets.assetImage?.url
                          : '',
                        ''
                      )
                    "
                    alt=""
                    style="max-height: 175px; width: 175px"
                  />
                  <!-- <img
                    src="../../../assets/img/default-asset.jpg"
                    alt=""
                    style="max-height: 175px; width: auto"
                  /> -->
                </div>
              </div>
            </div>
            <div fxFlex.gt-sm="35" fxFlex="100" class="m-0 my-mat-cardt d-wrap">
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Asset No</small>
                <mat-label class="d-block"
                  ><b>{{ prestartDetails?.assets?.assetNo }}</b></mat-label
                >
              </div>
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Asset Name</small>
                <mat-label class="d-block"
                  ><b>{{ prestartDetails?.assets?.name }}</b></mat-label
                >
              </div>
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Class </small>
                <mat-label class="d-block">{{
                  prestartDetails?.assets?.assetClass?.name
                }}</mat-label>
              </div>
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Type</small>
                <mat-label class="d-block">{{
                  prestartDetails?.assets?.assetType?.name
                }}</mat-label>
              </div>
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Make</small>
                <mat-label class="d-block">{{ prestartDetails?.assets?.make }}</mat-label>
              </div>
              <div fxFlex.gt-sm="50" fxFlex="100" class="p-b-10 p-t-10">
                <small>Model</small>
                <mat-label class="d-block">{{ prestartDetails?.assets?.model }}</mat-label>
              </div>
            </div>
            <div fxFlex.gt-sm="47" fxFlex="100" class="m-0 my-mat-cardt d-wrap">
              <div fxFlex.gt-sm="40" fxFlex="100">
                <div class="m-t-10">
                  <img (click)="openImageDialog($event.target.src)"
                    onerror="this.onerror=null;this.src='../../../assets/img/truck_selfie.png';"
                    [src]="
                    globals.generateFileUrl(
                    prestartDetails && prestartDetails.employeeSelfie ? prestartDetails.employeeSelfie.url : '','')"
                    alt=""
                    style="max-height: 175px; width: 175px"
                  />
                </div>
              </div>
              <div fxFlex.gt-sm="60" fxFlex="100" class="m-0 my-mat-cardt d-wrap">
                <div fxFlex.gt-sm="100" fxFlex="100" class="p-b-10 p-t-10 emp-mat-label email-lbl">
                  <img
                    class="m-r-10 User-Img"
                    onerror="this.onerror=null;this.src='../../assets/img/user-default-img.jpg';"
                    [src]="
                      globals.generateFileUrl(
                        prestartDetails &&
                          prestartDetails.operator &&
                          prestartDetails.operator.profileImage.length > 0
                          ? prestartDetails.operator.profileImage[0]?.digitalAssets?.url
                          : '',
                        ''
                      )
                    "
                    alt=""
                  />
                  <!-- <img
                    class="m-r-10 User-Img"
                    src="../../../assets/img/user-default-img.jpg"
                    alt=""
                  /> -->
                  <mat-label
                    ><b>{{
                      prestartDetails?.operator?.firstName +
                        ' ' +
                        prestartDetails?.operator?.lastName
                    }}</b></mat-label
                  >
                </div>
                <div fxFlex.gt-sm="100" fxFlex="100" class="p-10 emp-mat-label email-lbl">
                  <mat-icon>smartphone</mat-icon>
                  <mat-label> {{ prestartDetails?.operator?.phone }}</mat-label>
                </div>
                <div fxFlex.gt-sm="100" fxFlex="100" class="p-10 emp-mat-label email-lbl">
                  <div fxFlex.gt-sm="10" fxFlex="100" >
                    <mat-icon>view_carousel</mat-icon>
                  </div>
                  <div fxFlex.gt-sm="80" fxFlex="100"class="m-r-10 m-l-10" >
                    <mat-label> {{ prestartDetails?.prestartLocation }}</mat-label>
                  </div>
                  <div fxFlex.gt-sm="10" fxFlex="100" >
                    <mat-icon class="m-l-20" class="color_blue" style="cursor: pointer;" > location_on</mat-icon>
                  </div>
                 
                  
                 
                </div>
              </div>
            </div>
            <div fxFlex.gt-sm="73" fxFlex="100">
              <!-- <mat-card class="m-0 my-mat-cardf"> -->
              <!-- <mat-card-title class="p-10 color_blue" >Description</mat-card-title> -->
              <mat-form-field appearance="outline" class="m-t-10 p-r-10">
                <mat-label>Operator's Comment</mat-label>
                <textarea
                  matInput
                  [readonly]="isEditEnable"
                  value="{{ prestartDetails?.employeeRemark }}"
                  placeholder="Operator's Comment"
                  rows="2"
                ></textarea>
              </mat-form-field>
              <!-- </mat-card> -->
            </div>
            <div fxFlex.gt-sm="27" fxFlex="100" class="p-b-10 p-t-20 p-l-10">
              <!-- <small class="text-muted">Employee Number</small>
              <mat-label class="d-block">employeeNo</mat-label> -->
              <mat-label class="emp-mat-label email-lbl">
                <mat-icon>watch_later</mat-icon>
                <span class="p-l-10" style="word-break: break-word">Duration</span>
              </mat-label>
              <div class="m-l-20">
                <!-- <small>08:00 PM</small> -->
                <small>  {{ prestartDetails?.startTime | date:'shortTime' }}</small>
                -
                <!-- <small>08:20 PM</small> -->
                <small>{{prestartDetails?.endTime | date:'shortTime'}}</small>
              </div>
            </div>

            <div fxFlex.gt-sm="100" fxFlex="100" class="p-t-10">
              <div fxFlex.gt-sm="30" fxFlex="100" class="p-t-10">
                <mat-card-title class="color_blue">Inspections </mat-card-title>
              </div>
              <!-- <div fxFlex.gt-sm="70" fxFlex="100" >
                <div class="m-0" align="end">
                  <button class="m-l-20 m-r-20" mat-raised-button color="primary">
                    Deactivate
                  </button>
                  <button class="m-l-20 m-r-20" mat-raised-button color="primary">
                    Plant Deactivate
                  </button>
                </div>
              </div> -->
             
            </div>

            <div fxFlex.gt-sm="100" fxFlex="100" class="p-t-10">
              <mat-card>
                <mat-accordion class="p-l-0 p-r-0">
                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title><b>Category A </b> </mat-panel-title>
                      </div>
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title>Critical</mat-panel-title>
                      </div>
                        <div fxFlex.gt-sm="40" fxFlex="100">
                          <mat-panel-description  *ngIf="a_issue_count >= 1"  class="text-red"> {{ a_issue_count }}  Issues</mat-panel-description>
                      <mat-panel-description  *ngIf="a_issue_count == 0"  class="text-green"> No Issues</mat-panel-description>
                        </div>
                      <!-- <mat-panel-title><b>Category A </b> </mat-panel-title>
                      <mat-panel-title>Critical</mat-panel-title>
                      <mat-panel-description  *ngIf="a_issue_count >= 1"  class="text-red"> {{ a_issue_count }}  Issues</mat-panel-description>
                      <mat-panel-description  *ngIf="a_issue_count == 0"  class="text-green"> No Issues</mat-panel-description> -->
                    </mat-expansion-panel-header>
                    <mat-card class="m-0 m-t-5 m-b-5">
                      <mat-card-content>
                        <div class="table-responsive infinite-scroll">
                          <mat-table
                            #table
                            [dataSource]="dataSource_a"
                            class="table prestart-list no-wrap"
                            matSort
                          >
                            <!-- Name Column -->
                            <ng-container matColumnDef="icon">
                              <th mat-header-cell *matHeaderCellDef></th>
                              <td mat-cell *matCellDef="let row; let index = dataIndex">
                                <!-- <mat-icon>fiber_manual_record</mat-icon> -->
                                <img
                                  class="m-r-10 User-Img"
                                  src="../../../assets/img/inspection-icons/{{ row?.item?.icon }}.svg"                                alt=""
                                />
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="name">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
                              <td mat-cell *matCellDef="let row">
                                {{ row?.item?.inspectionName }}
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="status">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon
                                  *ngIf="row?.answer == 1"
                                  style="cursor: pointer; color: rgb(144,238,144)" 
                                  >thumb_up</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 2"
                                  style="cursor: pointer; color: rgb(255,150, 79); margin-left: 5px"
                                  >thumb_down</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 3"
                                  style="cursor: pointer; color: #1e88e5; margin-left: 5px"
                                  >hourglass_empty</mat-icon
                                >
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="comment">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Comment</th>
                              <td mat-cell *matCellDef="let row">
                                <div style="display: flex; align-items: center">
                                  <!--<img
                                    class="m-r-10 list-Img"
                                    onerror="this.onerror=null;this.src='../../assets/img/user-default-img.jpg';"
                                    [src]="
                                                    row && row.profileImage && row.profileImage.length > 0
                                                      ? row.profileImage[0]?.digitalAssets?.url
                                                      : ''
                                                  "
                                    alt=""
                                  />-->
                                  {{ row?.comment }}
                                </div>
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="media">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon *ngIf="row?.difectMedia != null"  href="javascript:void(0);" (click)="viewDefect(row.difectMedia.url)"
                                  >remove_red_eye</mat-icon
                                >
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="tickbox">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-checkbox >
                                </mat-checkbox>
                                
                              </td>
                            </ng-container> -->

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr
                              mat-row
                              *matRowDef="let element; columns: displayedColumns"
                              class="example-element-row"
                              [ngClass]="{ 'selected-row': selectedId == element.id }"
                            ></tr>
                            <tr class="mat-row" *matNoDataRow>
                              <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                                No Data Available
                              </td>
                            </tr>
                          </mat-table>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  </mat-expansion-panel>

                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <!-- <div fxFlex.gt-sm="100" fxFlex="100"></div> -->
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title><b>Category B </b> </mat-panel-title>
                      </div>
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title>Potential to Damege</mat-panel-title>
                      </div>
                      <div fxFlex.gt-sm="40" fxFlex="100">
                        <mat-panel-description  *ngIf="b_issue_count >= 1"  class="text-red"> {{ b_issue_count }}  Issues</mat-panel-description>
                      <mat-panel-description  *ngIf="b_issue_count == 0"  class="text-green"> No Issues</mat-panel-description>

                      </div>
                      <!-- <mat-panel-title><b>Category B </b> </mat-panel-title>
                      <mat-panel-title>Potential to Damege</mat-panel-title>
                      <mat-panel-description  *ngIf="b_issue_count >= 1"  class="text-red"> {{ b_issue_count }}  Issues</mat-panel-description>
                      <mat-panel-description  *ngIf="b_issue_count == 0"  class="text-green"> No Issues</mat-panel-description> -->

                    </mat-expansion-panel-header>
                    <mat-card class="m-0 m-t-5 m-b-5">
                      <mat-card-content>
                        <div class="table-responsive infinite-scroll">
                          <mat-table
                            #table
                            [dataSource]="dataSource_b"
                            class="table prestart-list no-wrap"
                            matSort
                          >
                            <!-- Name Column -->
                            <ng-container matColumnDef="icon">
                              <th mat-header-cell *matHeaderCellDef></th>
                              <td mat-cell *matCellDef="let row; let index = dataIndex">
                                <!-- <mat-icon>fiber_manual_record</mat-icon> -->
                                <img
                                  class="m-r-10 User-Img"
                                  src="../../../assets/img/inspection-icons/{{ row?.item?.icon }}.svg"                                alt=""
                                />
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="name">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
                              <td mat-cell *matCellDef="let row">
                                {{ row?.item?.inspectionName }}
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="status">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon
                                  *ngIf="row?.answer == 1"
                                  style="cursor: pointer; color: rgb(144,238,144)"
                                >thumb_up</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 2"
                                  style="cursor: pointer; color: rgb(255,150, 79); margin-left: 5px"
                                >thumb_down</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 3"
                                  style="cursor: pointer; color: #1e88e5; margin-left: 5px"
                                >hourglass_empty</mat-icon
                                >
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="comment">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Comment</th>
                              <td mat-cell *matCellDef="let row">
                                <div style="display: flex; align-items: center">
                                  <!--<img
                                    class="m-r-10 list-Img"
                                    onerror="this.onerror=null;this.src='../../assets/img/user-default-img.jpg';"
                                    [src]="
                                                    row && row.profileImage && row.profileImage.length > 0
                                                      ? row.profileImage[0]?.digitalAssets?.url
                                                      : ''
                                                  "
                                    alt=""
                                  />-->
                                  {{ row?.comment }}
                                </div>
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="media">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon *ngIf="row?.difectMedia != null"  href="javascript:void(0);" (click)="viewDefect(row.difectMedia.url)"
                                >remove_red_eye</mat-icon
                                >
                              </td>
                            </ng-container>
                            <!-- <ng-container matColumnDef="tickbox">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-checkbox >
                                </mat-checkbox>
                              </td>
                            </ng-container> -->

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr
                              mat-row
                              *matRowDef="let element; columns: displayedColumns"
                              class="example-element-row"
                              [ngClass]="{ 'selected-row': selectedId == element.id }"
                            ></tr>
                            <tr class="mat-row" *matNoDataRow>
                              <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                                No Data Available
                              </td>
                            </tr>
                          </mat-table>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  </mat-expansion-panel>

                  <mat-expansion-panel>
                    <mat-expansion-panel-header>
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title><b>Category C  </b> </mat-panel-title>
                      </div> 
                      <div fxFlex.gt-sm="30" fxFlex="100">
                        <mat-panel-title>Non-Critical </mat-panel-title>
                      </div> 
                      <div fxFlex.gt-sm="40" fxFlex="100">
                        <mat-panel-description  *ngIf="c_issue_count >= 1"  class="text-red"> {{ c_issue_count }}  Issues</mat-panel-description>
                        <mat-panel-description  *ngIf="c_issue_count == 0"  class="text-green"> No Issues</mat-panel-description>
                      </div> 
                      <!-- <mat-panel-title><b>Category C  </b> </mat-panel-title>
                      <mat-panel-title>Non-Critical </mat-panel-title>
                      <mat-panel-description  *ngIf="c_issue_count >= 1"  class="text-red"> {{ c_issue_count }}  Issues</mat-panel-description>
                      <mat-panel-description  *ngIf="c_issue_count == 0"  class="text-green"> No Issues</mat-panel-description> -->
                    </mat-expansion-panel-header>
                    <mat-card class="m-0 m-t-5 m-b-5">
                      <mat-card-content>
                        <div class="table-responsive infinite-scroll">
                          <mat-table
                            #table
                            [dataSource]="dataSource_c"
                            class="table prestart-list no-wrap"
                            matSort
                          >
                            <!-- Name Column -->
                            <ng-container matColumnDef="icon">
                              <th mat-header-cell *matHeaderCellDef></th>
                              <td mat-cell *matCellDef="let row; let index = dataIndex">
                                <!-- <mat-icon>fiber_manual_record</mat-icon> -->
                                <img
                                  class="m-r-10 User-Img"
                                  src="../../../assets/img/inspection-icons/{{ row?.item?.icon }}.svg"                                alt=""
                                />
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="name">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
                              <td mat-cell *matCellDef="let row">
                                {{ row?.item?.inspectionName }}
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="status">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon
                                  *ngIf="row?.answer == 1"
                                  style="cursor: pointer; color: rgb(144,238,144)"
                                >thumb_up</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 2"
                                  style="cursor: pointer; color: rgb(255,150, 79); margin-left: 5px"
                                >thumb_down</mat-icon
                                >
                                <mat-icon
                                  *ngIf="row?.answer == 3"
                                  style="cursor: pointer; color: #1e88e5; margin-left: 5px"
                                >hourglass_empty</mat-icon
                                >
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="comment">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Comment</th>
                              <td mat-cell *matCellDef="let row">
                                <div style="display: flex; align-items: center">
                                  <!--<img
                                    class="m-r-10 list-Img"
                                    onerror="this.onerror=null;this.src='../../assets/img/user-default-img.jpg';"
                                    [src]="
                                                    row && row.profileImage && row.profileImage.length > 0
                                                      ? row.profileImage[0]?.digitalAssets?.url
                                                      : ''
                                                  "
                                    alt=""
                                  />-->
                                  {{ row?.comment }}
                                </div>
                              </td>
                            </ng-container>

                            <ng-container matColumnDef="media">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-icon *ngIf="row?.difectMedia != null"  href="javascript:void(0);" (click)="viewDefect(row.difectMedia.url)"
                                >remove_red_eye</mat-icon
                                >
                              </td>
                            </ng-container>
                            <!-- <ng-container matColumnDef="tickbox">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Media</th>
                              <td mat-cell *matCellDef="let row">
                                <mat-checkbox >
                                </mat-checkbox>
                              </td>
                            </ng-container> -->

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr
                              mat-row
                              *matRowDef="let element; columns: displayedColumns"
                              class="example-element-row"
                              [ngClass]="{ 'selected-row': selectedId == element.id }"
                            ></tr>
                          </mat-table>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  </mat-expansion-panel>
                </mat-accordion>
              </mat-card>
            </div>
          </div>
        </form>
      </div>
    </div>
  </mat-card-content>
</mat-card>

<ng-template #imageDialog>
  <div fxLayout="column wrap">
    <div fxFlex.gt-sm="100" fxFlex="100" fxFlexAlign="center" class="row m-0">
      <img class="m-r-10 Media-Img"
           onerror="this.onerror=null;this.src='../../../assets/img/user-default-img.jpg';"
           [src]="
                      globals.generateFileUrl(defectUrl,'')
                    "alt="" />
    </div>
  </div>
</ng-template>
